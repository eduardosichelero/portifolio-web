import{r as a,j as e}from"./index-BlTBJpj7.js";function B({onLogin:x}){const[n,h]=a.useState(""),[c,v]=a.useState(""),[k,f]=a.useState(""),y=async s=>{s.preventDefault(),f("");const o=await fetch("https://portifolio-api-mu.vercel.app/api/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({usuario:n,senha:c})});if(o.ok){const{token:d}=await o.json();sessionStorage.setItem("admin_token",d),x()}else f("Usuário ou senha inválidos")};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background-light dark:bg-background-dark",children:e.jsxs("form",{onSubmit:y,className:"bg-white dark:bg-gray-900 rounded-2xl shadow-lg p-8 min-w-[320px] flex flex-col gap-5",children:[e.jsx("h2",{className:"text-center text-primary-light dark:text-primary-dark font-bold text-2xl mb-2",children:"Painel Admin"}),e.jsx("label",{className:"font-medium text-gray-600 dark:text-gray-300",children:"Usuário"}),e.jsx("input",{placeholder:"Digite seu usuário",value:n,onChange:s=>h(s.target.value),required:!0,className:"p-2 rounded-lg border border-border-light dark:border-border-dark text-base bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark"}),e.jsx("label",{className:"font-medium text-gray-600 dark:text-gray-300",children:"Senha"}),e.jsx("input",{type:"password",placeholder:"Digite sua senha",value:c,onChange:s=>v(s.target.value),required:!0,className:"p-2 rounded-lg border border-border-light dark:border-border-dark text-base bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark"}),e.jsx("button",{type:"submit",className:"mt-2 bg-primary-light dark:bg-primary-dark text-white rounded-lg py-3 font-semibold text-lg cursor-pointer shadow transition hover:bg-primary-dark dark:hover:bg-primary-light",children:"Entrar"}),k&&e.jsx("div",{className:"text-red-600 text-center mt-2",children:k})]})})}function Q(){const[x,n]=a.useState([]),[h,c]=a.useState([]),[v,k]=a.useState(!0),[f,y]=a.useState(!0),[s,o]=a.useState({id:"",title:"",deadline:"",progress:0,category:""}),[d,l]=a.useState({id:"",title:"",date:"",issuer:"",progress:0,externalUrl:""}),[p,w]=a.useState(null),[m,C]=a.useState(null),[L,j]=a.useState(""),[P,q]=a.useState([]),[S,I]=a.useState(!1),[U,T]=a.useState(!1),[E,D]=a.useState(""),O=async()=>{T(!0),D("");try{const r=await fetch("https://portifolio-api-mu.vercel.app/api/admin-logs",{credentials:"include"});if(r.ok){const t=await r.json();q(t)}else D("Acesso negado ou erro ao buscar logs.")}catch{D("Erro de conexão ao buscar logs.")}T(!1)};a.useEffect(()=>{Promise.all([fetch("https://portifolio-api-mu.vercel.app/api/goals",{credentials:"include"}),fetch("https://portifolio-api-mu.vercel.app/api/certificates",{credentials:"include"})]).then(async([r,t])=>{if(r.status===401||t.status===401){y(!1);return}const g=await r.json(),i=await t.json();n(Array.isArray(g)?g:g.goals||[]),c(Array.isArray(i)?i:i.certificates||[]),k(!1)})},[]);const J=async r=>{if(r.preventDefault(),p){const t={...s,id:p};(await fetch(`https://portifolio-api-mu.vercel.app/api/goals/${p}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"})).ok&&(n(x.map(i=>i.id===p?t:i)),o({id:"",title:"",deadline:"",progress:0,category:""}),w(null))}else{const t={...s,id:crypto.randomUUID()};(await fetch("https://portifolio-api-mu.vercel.app/api/goals",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"})).ok&&(n([...x,t]),o({id:"",title:"",deadline:"",progress:0,category:""}))}},F=r=>{o(r),w(r.id)},[u,b]=a.useState(null),[G,N]=a.useState(""),R=async r=>{b({type:"goal",id:r})},$=async r=>{await fetch(`https://portifolio-api-mu.vercel.app/api/goals/${r}`,{method:"DELETE",credentials:"include"}),n(x.filter(t=>t.id!==r)),b(null),N("Goal removido com sucesso!"),setTimeout(()=>N(""),2500)},z=async r=>{r.preventDefault(),j("");try{if(m){const t={...d,id:m};if((await fetch(`https://portifolio-api-mu.vercel.app/api/certificates/${m}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"})).ok){const i=await fetch("https://portifolio-api-mu.vercel.app/api/certificates",{credentials:"include"}).then(A=>A.json());c(Array.isArray(i)?i:i.certificates||[]),l({id:"",title:"",date:"",issuer:"",progress:0,externalUrl:""}),C(null)}else j("Erro ao editar certificado.")}else{const t={...d,id:crypto.randomUUID()};if((await fetch("https://portifolio-api-mu.vercel.app/api/certificates",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"})).ok){const i=await fetch("https://portifolio-api-mu.vercel.app/api/certificates",{credentials:"include"}).then(A=>A.json());c(Array.isArray(i)?i:i.certificates||[]),l({id:"",title:"",date:"",issuer:"",progress:0,externalUrl:""})}else j("Erro ao adicionar certificado.")}}catch{j("Erro de conexão com o servidor.")}},M=r=>{l(r),C(r.id)},V=async r=>{b({type:"cert",id:r})},_=async r=>{await fetch(`https://portifolio-api-mu.vercel.app/api/certificates/${r}`,{method:"DELETE",credentials:"include"}),c(h.filter(t=>t.id!==r)),b(null),N("Certificado removido com sucesso!"),setTimeout(()=>N(""),2500)},H=()=>{window.location.reload()};return f?v?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background-light dark:bg-background-dark",children:e.jsx("div",{className:"text-primary-light dark:text-primary-dark text-2xl font-semibold",children:"Carregando..."})}):e.jsx("div",{className:"min-h-screen bg-background-light dark:bg-background-dark font-sans",children:e.jsxs("div",{className:"max-w-3xl mx-auto my-10 bg-white dark:bg-gray-900 rounded-2xl shadow-lg p-8 flex flex-col gap-8",children:[e.jsxs("header",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-primary-light dark:text-primary-dark font-bold text-3xl m-0",children:"Painel Admin"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"bg-primary-light dark:bg-primary-dark text-white rounded-lg px-4 py-2 font-semibold shadow transition hover:bg-primary-dark dark:hover:bg-primary-light",onClick:H,children:"Sair"}),e.jsx("button",{className:"bg-gray-200 dark:bg-gray-700 text-primary-light dark:text-primary-dark rounded-lg px-4 py-2 font-semibold",onClick:()=>{I(r=>!r),S||O()},children:S?"Ocultar Logs":"Ver Logs"})]})]}),S&&e.jsxs("section",{className:"mb-6",children:[e.jsx("h3",{className:"text-primary-light dark:text-primary-dark font-semibold text-xl mb-3",children:"Logs Administrativos"}),U&&e.jsx("div",{className:"text-gray-500",children:"Carregando logs..."}),E&&e.jsx("div",{className:"text-red-600",children:E}),!U&&!E&&e.jsx("div",{className:"overflow-x-auto max-h-96",children:e.jsxs("table",{className:"min-w-full text-xs text-left border border-border-light dark:border-border-dark",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100 dark:bg-gray-800",children:[e.jsx("th",{className:"p-2",children:"Data/Hora"}),e.jsx("th",{className:"p-2",children:"IP"}),e.jsx("th",{className:"p-2",children:"Usuário"}),e.jsx("th",{className:"p-2",children:"Ação"}),e.jsx("th",{className:"p-2",children:"Detalhes"})]})}),e.jsx("tbody",{children:P.map((r,t)=>e.jsxs("tr",{className:"border-t border-border-light dark:border-border-dark",children:[e.jsx("td",{className:"p-2 whitespace-nowrap",children:new Date(r.timestamp).toLocaleString()}),e.jsx("td",{className:"p-2",children:r.ip}),e.jsx("td",{className:"p-2",children:r.usuario}),e.jsx("td",{className:"p-2",children:r.acao}),e.jsx("td",{className:"p-2",children:r.detalhes})]},t))})]})})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-primary-light dark:text-primary-dark font-semibold text-xl mb-3",children:"Goals"}),e.jsxs("form",{className:"flex flex-wrap gap-3 mb-6",onSubmit:J,children:[e.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Título",value:s.title,onChange:r=>o({...s,title:r.target.value}),required:!0,"aria-label":"Título do Goal"}),e.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Deadline",value:s.deadline,onChange:r=>o({...s,deadline:r.target.value}),required:!0,"aria-label":"Deadline do Goal"}),e.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Categoria",value:s.category,onChange:r=>o({...s,category:r.target.value}),required:!0,"aria-label":"Categoria do Goal"}),e.jsx("input",{type:"number",className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Progresso",value:s.progress,onChange:r=>o({...s,progress:Number(r.target.value)}),min:0,max:100,required:!0,"aria-label":"Progresso do Goal"}),e.jsx("button",{type:"submit",className:"bg-primary-light dark:bg-primary-dark text-white rounded-lg px-4 py-2 font-semibold transition hover:bg-primary-dark dark:hover:bg-primary-light",children:p?"Salvar Alteração":"Adicionar Goal"}),p&&e.jsx("button",{type:"button",className:"bg-gray-200 dark:bg-gray-700 text-primary-light dark:text-primary-dark rounded-lg px-4 py-2 font-semibold",onClick:()=>{w(null),o({id:"",title:"",deadline:"",progress:0,category:""})},children:"Cancelar"})]}),e.jsx("ul",{className:"space-y-2",children:x.map(r=>e.jsxs("li",{className:"bg-background-light dark:bg-gray-800 rounded-lg p-4 flex items-center justify-between gap-2 flex-wrap border border-border-light dark:border-border-dark",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-text-light dark:text-text-dark",children:r.title}),e.jsxs("span",{className:"text-primary-light dark:text-primary-dark font-semibold ml-2",children:[r.progress,"%"]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[r.category," | ",r.deadline]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>R(r.id),className:"bg-red-600 text-white rounded px-3 py-1 font-medium",children:"Remover"}),e.jsx("button",{onClick:()=>F(r),className:"bg-primary-light dark:bg-primary-dark text-white rounded px-3 py-1 font-medium",children:"Editar"})]})]},r.id))})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-primary-light dark:text-primary-dark font-semibold text-xl mb-3",children:"Certificados"}),e.jsxs("form",{className:"flex flex-wrap gap-3 mb-6",onSubmit:z,children:[e.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Título",value:d.title,onChange:r=>l({...d,title:r.target.value}),required:!0,"aria-label":"Título do Certificado"}),e.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Data",value:d.date,onChange:r=>l({...d,date:r.target.value}),required:!0,"aria-label":"Data do Certificado"}),e.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Emissor",value:d.issuer,onChange:r=>l({...d,issuer:r.target.value}),required:!0,"aria-label":"Emissor do Certificado"}),e.jsx("input",{type:"number",className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Progresso",value:d.progress,onChange:r=>l({...d,progress:Number(r.target.value)}),min:0,max:100,required:!0,"aria-label":"Progresso do Certificado"}),e.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"URL externa",value:d.externalUrl,onChange:r=>l({...d,externalUrl:r.target.value}),"aria-label":"URL externa do Certificado"}),e.jsx("button",{type:"submit",className:"bg-primary-light dark:bg-primary-dark text-white rounded-lg px-4 py-2 font-semibold transition hover:bg-primary-dark dark:hover:bg-primary-light",children:m?"Salvar Alteração":"Adicionar Certificado"}),m&&e.jsx("button",{type:"button",className:"bg-gray-200 dark:bg-gray-700 text-primary-light dark:text-primary-dark rounded-lg px-4 py-2 font-semibold",onClick:()=>{C(null),l({id:"",title:"",date:"",issuer:"",progress:0,externalUrl:""})},children:"Cancelar"})]}),L&&e.jsx("div",{className:"text-red-600 mb-4",role:"alert",children:L}),e.jsx("ul",{className:"space-y-2",children:h.map(r=>e.jsxs("li",{className:"bg-background-light dark:bg-gray-800 rounded-lg p-4 flex items-center justify-between gap-2 flex-wrap border border-border-light dark:border-border-dark",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-text-light dark:text-text-dark",children:r.title}),e.jsx("span",{className:"text-primary-light dark:text-primary-dark font-semibold ml-2",children:r.issuer}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[r.date," | ",r.progress,"% ",r.externalUrl&&e.jsx("a",{href:r.externalUrl,target:"_blank",rel:"noopener noreferrer",className:"text-primary-light dark:text-primary-dark underline ml-2",children:"Ver"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>V(r.id),className:"bg-red-600 text-white rounded px-3 py-1 font-medium",children:"Remover"}),e.jsx("button",{onClick:()=>M(r),className:"bg-primary-light dark:bg-primary-dark text-white rounded px-3 py-1 font-medium",children:"Editar"})]})]},r.id))})]}),G&&e.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 bg-green-600 text-white px-6 py-2 rounded shadow-lg z-50 transition",children:G}),u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl p-6 shadow-lg flex flex-col gap-4 min-w-[300px]",children:[e.jsxs("span",{className:"text-lg text-gray-800 dark:text-gray-100 font-semibold",children:["Tem certeza que deseja remover ",u.type==="goal"?"este Goal":"este Certificado","?"]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{className:"bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded px-4 py-2 font-medium",onClick:()=>b(null),children:"Cancelar"}),e.jsx("button",{className:"bg-red-600 text-white rounded px-4 py-2 font-medium",onClick:()=>u.type==="goal"?$(u.id):_(u.id),children:"Remover"})]})]})})]})}):e.jsx(B,{onLogin:()=>y(!0)})}export{Q as default};
