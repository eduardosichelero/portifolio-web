import{r as s,j as t}from"./index-fw4sfqtY.js";function U({onLogin:d}){const[l,h]=s.useState(""),[u,f]=s.useState(""),[g,m]=s.useState(""),x=async r=>{r.preventDefault(),m("");const n=await fetch("https://portifolio-api-mu.vercel.app/api/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({usuario:l,senha:u})});if(n.ok){const{token:a}=await n.json();localStorage.setItem("admin_token",a),d()}else m("Usuário ou senha inválidos")};return t.jsxs("form",{onSubmit:x,style:{maxWidth:320,margin:"80px auto",display:"flex",flexDirection:"column",gap:12},children:[t.jsx("h2",{style:{textAlign:"center"},children:"Login Admin"}),t.jsx("input",{placeholder:"Usuário",value:l,onChange:r=>h(r.target.value),required:!0}),t.jsx("input",{type:"password",placeholder:"Senha",value:u,onChange:r=>f(r.target.value),required:!0}),t.jsx("button",{type:"submit",children:"Entrar"}),g&&t.jsx("div",{style:{color:"red",textAlign:"center"},children:g})]})}function T(){const[d,l]=s.useState([]),[h,u]=s.useState([]),[f,g]=s.useState(!0),[m,x]=s.useState(()=>!!localStorage.getItem("admin_token")),[r,n]=s.useState({id:"",title:"",deadline:"",progress:0,category:""}),[a,c]=s.useState({id:"",title:"",date:"",issuer:"",progress:0,externalUrl:""}),[p,j]=s.useState(null);s.useEffect(()=>{Promise.all([fetch("https://portifolio-api-mu.vercel.app/api/goals").then(e=>e.json()),fetch("https://portifolio-api-mu.vercel.app/api/certificates").then(e=>e.json())]).then(([e,o])=>{l(Array.isArray(e)?e:e.goals||[]),u(Array.isArray(o)?o:o.certificates||[]),g(!1)})},[]);const S=async e=>{e.preventDefault();const o=localStorage.getItem("admin_token");if(p){const i={...r,id:p};(await fetch(`https://portifolio-api-mu.vercel.app/api/goals/${p}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify(i)})).ok&&(l(d.map(v=>v.id===p?i:v)),n({id:"",title:"",deadline:"",progress:0,category:""}),j(null))}else{const i={...r,id:crypto.randomUUID()};(await fetch("https://portifolio-api-mu.vercel.app/api/goals",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify(i)})).ok&&(l([...d,i]),n({id:"",title:"",deadline:"",progress:0,category:""}))}},C=e=>{n(e),j(e.id)},b=async e=>{const o=localStorage.getItem("admin_token");await fetch(`https://portifolio-api-mu.vercel.app/api/goals/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${o}`}}),l(d.filter(i=>i.id!==e))},k=async e=>{e.preventDefault();const o=localStorage.getItem("admin_token"),i={...a,id:crypto.randomUUID()};(await fetch("https://portifolio-api-mu.vercel.app/api/certificates",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify(i)})).ok&&(u([...h,i]),c({id:"",title:"",date:"",issuer:"",progress:0,externalUrl:""}))},A=async e=>{const o=localStorage.getItem("admin_token");await fetch(`https://portifolio-api-mu.vercel.app/api/certificates/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${o}`}}),u(h.filter(i=>i.id!==e))},E=()=>{localStorage.removeItem("admin_token"),window.location.reload()};return m?f?t.jsx("div",{children:"Carregando..."}):t.jsxs("div",{children:[t.jsx("button",{onClick:E,style:{float:"right",margin:8},children:"Sair"}),t.jsx("h2",{children:"Painel Admin"}),t.jsx("h3",{children:"Goals"}),t.jsxs("form",{onSubmit:S,style:{marginBottom:16},children:[t.jsx("input",{placeholder:"Título",value:r.title,onChange:e=>n({...r,title:e.target.value}),required:!0}),t.jsx("input",{placeholder:"Deadline",value:r.deadline,onChange:e=>n({...r,deadline:e.target.value}),required:!0}),t.jsx("input",{placeholder:"Categoria",value:r.category,onChange:e=>n({...r,category:e.target.value}),required:!0}),t.jsx("input",{type:"number",placeholder:"Progresso",value:r.progress,onChange:e=>n({...r,progress:Number(e.target.value)}),min:0,max:100,required:!0}),t.jsx("button",{type:"submit",children:p?"Salvar Alteração":"Adicionar Goal"}),p&&t.jsx("button",{type:"button",onClick:()=>{j(null),n({id:"",title:"",deadline:"",progress:0,category:""})},children:"Cancelar"})]}),t.jsx("ul",{children:d.map(e=>t.jsxs("li",{children:[e.title," - ",e.progress,"%",t.jsx("button",{onClick:()=>b(e.id),children:"Remover"}),t.jsx("button",{onClick:()=>C(e),children:"Editar"})]},e.id))}),t.jsx("h3",{children:"Certificados"}),t.jsxs("form",{onSubmit:k,style:{marginBottom:16},children:[t.jsx("input",{placeholder:"Título",value:a.title,onChange:e=>c({...a,title:e.target.value}),required:!0}),t.jsx("input",{placeholder:"Data",value:a.date,onChange:e=>c({...a,date:e.target.value}),required:!0}),t.jsx("input",{placeholder:"Emissor",value:a.issuer,onChange:e=>c({...a,issuer:e.target.value}),required:!0}),t.jsx("input",{type:"number",placeholder:"Progresso",value:a.progress,onChange:e=>c({...a,progress:Number(e.target.value)}),min:0,max:100,required:!0}),t.jsx("input",{placeholder:"URL externa",value:a.externalUrl,onChange:e=>c({...a,externalUrl:e.target.value})}),t.jsx("button",{type:"submit",children:"Adicionar Certificado"})]}),t.jsx("ul",{children:h.map(e=>t.jsxs("li",{children:[e.title," - ",e.issuer,t.jsx("button",{onClick:()=>A(e.id),children:"Remover"})]},e.id))})]}):t.jsx(U,{onLogin:()=>x(!0)})}export{T as default};
