import{r as a,j as e}from"./index-1f1y1Xem.js";function J({onLogin:x}){const[c,h]=a.useState(""),[g,f]=a.useState(""),[b,u]=a.useState(""),y=async s=>{s.preventDefault(),u("");const o=await fetch("https://portifolio-api-mu.vercel.app/api/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({usuario:c,senha:g})});if(o.ok){const{token:i}=await o.json();sessionStorage.setItem("admin_token",i),x()}else u("Usuário ou senha inválidos")};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background-light dark:bg-background-dark",children:e.jsxs("form",{onSubmit:y,className:"bg-white dark:bg-gray-900 rounded-2xl shadow-lg p-8 min-w-[320px] flex flex-col gap-5",children:[e.jsx("h2",{className:"text-center text-primary-light dark:text-primary-dark font-bold text-2xl mb-2",children:"Painel Admin"}),e.jsx("label",{className:"font-medium text-gray-600 dark:text-gray-300",children:"Usuário"}),e.jsx("input",{placeholder:"Digite seu usuário",value:c,onChange:s=>h(s.target.value),required:!0,className:"p-2 rounded-lg border border-border-light dark:border-border-dark text-base bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark"}),e.jsx("label",{className:"font-medium text-gray-600 dark:text-gray-300",children:"Senha"}),e.jsx("input",{type:"password",placeholder:"Digite sua senha",value:g,onChange:s=>f(s.target.value),required:!0,className:"p-2 rounded-lg border border-border-light dark:border-border-dark text-base bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark"}),e.jsx("button",{type:"submit",className:"mt-2 bg-primary-light dark:bg-primary-dark text-white rounded-lg py-3 font-semibold text-lg cursor-pointer shadow transition hover:bg-primary-dark dark:hover:bg-primary-light",children:"Entrar"}),b&&e.jsx("div",{className:"text-red-600 text-center mt-2",children:b})]})})}function F(){const[x,c]=a.useState([]),[h,g]=a.useState([]),[f,b]=a.useState(!0),[u,y]=a.useState(()=>!!sessionStorage.getItem("admin_token")),[s,o]=a.useState({id:"",title:"",deadline:"",progress:0,category:""}),[i,n]=a.useState({id:"",title:"",date:"",issuer:"",progress:0,externalUrl:""}),[p,j]=a.useState(null),[m,N]=a.useState(null),[E,k]=a.useState(""),[T,I]=a.useState([]),[v,P]=a.useState(!1),[L,U]=a.useState(!1),[w,C]=a.useState(""),D=async()=>{U(!0),C("");try{const r=await fetch("https://portifolio-api-mu.vercel.app/api/admin-logs",{credentials:"include"});if(r.ok){const t=await r.json();I(t)}else C("Acesso negado ou erro ao buscar logs.")}catch{C("Erro de conexão ao buscar logs.")}U(!1)};a.useEffect(()=>{Promise.all([fetch("https://portifolio-api-mu.vercel.app/api/goals",{credentials:"include"}).then(r=>r.json()),fetch("https://portifolio-api-mu.vercel.app/api/certificates",{credentials:"include"}).then(r=>r.json())]).then(([r,t])=>{c(Array.isArray(r)?r:r.goals||[]),g(Array.isArray(t)?t:t.certificates||[]),b(!1)})},[]);const G=async r=>{r.preventDefault();const t=sessionStorage.getItem("admin_token");if(p){const d={...s,id:p};(await fetch(`https://portifolio-api-mu.vercel.app/api/goals/${p}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(d),credentials:"include"})).ok&&(c(x.map(l=>l.id===p?d:l)),o({id:"",title:"",deadline:"",progress:0,category:""}),j(null))}else{const d={...s,id:crypto.randomUUID()};(await fetch("https://portifolio-api-mu.vercel.app/api/goals",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(d),credentials:"include"})).ok&&(c([...x,d]),o({id:"",title:"",deadline:"",progress:0,category:""}))}},q=r=>{o(r),j(r.id)},$=async r=>{const t=sessionStorage.getItem("admin_token");await fetch(`https://portifolio-api-mu.vercel.app/api/goals/${r}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`},credentials:"include"}),c(x.filter(d=>d.id!==r))},O=async r=>{r.preventDefault(),k("");const t=sessionStorage.getItem("admin_token");try{if(m){const d={...i,id:m};if((await fetch(`https://portifolio-api-mu.vercel.app/api/certificates/${m}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(d),credentials:"include"})).ok){const l=await fetch("https://portifolio-api-mu.vercel.app/api/certificates",{credentials:"include"}).then(A=>A.json());g(Array.isArray(l)?l:l.certificates||[]),n({id:"",title:"",date:"",issuer:"",progress:0,externalUrl:""}),N(null)}else k("Erro ao editar certificado.")}else{const d={...i,id:crypto.randomUUID()};if((await fetch("https://portifolio-api-mu.vercel.app/api/certificates",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(d),credentials:"include"})).ok){const l=await fetch("https://portifolio-api-mu.vercel.app/api/certificates",{credentials:"include"}).then(A=>A.json());g(Array.isArray(l)?l:l.certificates||[]),n({id:"",title:"",date:"",issuer:"",progress:0,externalUrl:""})}else k("Erro ao adicionar certificado.")}}catch{k("Erro de conexão com o servidor.")}},_=r=>{n(r),N(r.id)},z=async r=>{const t=sessionStorage.getItem("admin_token");await fetch(`https://portifolio-api-mu.vercel.app/api/certificates/${r}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`},credentials:"include"}),g(h.filter(d=>d.id!==r))},B=()=>{sessionStorage.removeItem("admin_token"),window.location.reload()};return u?f?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background-light dark:bg-background-dark",children:e.jsx("div",{className:"text-primary-light dark:text-primary-dark text-2xl font-semibold",children:"Carregando..."})}):e.jsx("div",{className:"min-h-screen bg-background-light dark:bg-background-dark font-sans",children:e.jsxs("div",{className:"max-w-3xl mx-auto my-10 bg-white dark:bg-gray-900 rounded-2xl shadow-lg p-8 flex flex-col gap-8",children:[e.jsxs("header",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-primary-light dark:text-primary-dark font-bold text-3xl m-0",children:"Painel Admin"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"bg-primary-light dark:bg-primary-dark text-white rounded-lg px-4 py-2 font-semibold shadow transition hover:bg-primary-dark dark:hover:bg-primary-light",onClick:B,children:"Sair"}),e.jsx("button",{className:"bg-gray-200 dark:bg-gray-700 text-primary-light dark:text-primary-dark rounded-lg px-4 py-2 font-semibold",onClick:()=>{P(r=>!r),v||D()},children:v?"Ocultar Logs":"Ver Logs"})]})]}),v&&e.jsxs("section",{className:"mb-6",children:[e.jsx("h3",{className:"text-primary-light dark:text-primary-dark font-semibold text-xl mb-3",children:"Logs Administrativos"}),L&&e.jsx("div",{className:"text-gray-500",children:"Carregando logs..."}),w&&e.jsx("div",{className:"text-red-600",children:w}),!L&&!w&&e.jsx("div",{className:"overflow-x-auto max-h-96",children:e.jsxs("table",{className:"min-w-full text-xs text-left border border-border-light dark:border-border-dark",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100 dark:bg-gray-800",children:[e.jsx("th",{className:"p-2",children:"Data/Hora"}),e.jsx("th",{className:"p-2",children:"IP"}),e.jsx("th",{className:"p-2",children:"Usuário"}),e.jsx("th",{className:"p-2",children:"Ação"}),e.jsx("th",{className:"p-2",children:"Detalhes"})]})}),e.jsx("tbody",{children:T.map((r,t)=>e.jsxs("tr",{className:"border-t border-border-light dark:border-border-dark",children:[e.jsx("td",{className:"p-2 whitespace-nowrap",children:new Date(r.timestamp).toLocaleString()}),e.jsx("td",{className:"p-2",children:r.ip}),e.jsx("td",{className:"p-2",children:r.usuario}),e.jsx("td",{className:"p-2",children:r.acao}),e.jsx("td",{className:"p-2",children:r.detalhes})]},t))})]})})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-primary-light dark:text-primary-dark font-semibold text-xl mb-3",children:"Goals"}),e.jsxs("form",{className:"flex flex-wrap gap-3 mb-6",onSubmit:G,children:[e.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Título",value:s.title,onChange:r=>o({...s,title:r.target.value}),required:!0,"aria-label":"Título do Goal"}),e.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Deadline",value:s.deadline,onChange:r=>o({...s,deadline:r.target.value}),required:!0,"aria-label":"Deadline do Goal"}),e.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Categoria",value:s.category,onChange:r=>o({...s,category:r.target.value}),required:!0,"aria-label":"Categoria do Goal"}),e.jsx("input",{type:"number",className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Progresso",value:s.progress,onChange:r=>o({...s,progress:Number(r.target.value)}),min:0,max:100,required:!0,"aria-label":"Progresso do Goal"}),e.jsx("button",{type:"submit",className:"bg-primary-light dark:bg-primary-dark text-white rounded-lg px-4 py-2 font-semibold transition hover:bg-primary-dark dark:hover:bg-primary-light",children:p?"Salvar Alteração":"Adicionar Goal"}),p&&e.jsx("button",{type:"button",className:"bg-gray-200 dark:bg-gray-700 text-primary-light dark:text-primary-dark rounded-lg px-4 py-2 font-semibold",onClick:()=>{j(null),o({id:"",title:"",deadline:"",progress:0,category:""})},children:"Cancelar"})]}),e.jsx("ul",{className:"space-y-2",children:x.map(r=>e.jsxs("li",{className:"bg-background-light dark:bg-gray-800 rounded-lg p-4 flex items-center justify-between gap-2 flex-wrap border border-border-light dark:border-border-dark",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-text-light dark:text-text-dark",children:r.title}),e.jsxs("span",{className:"text-primary-light dark:text-primary-dark font-semibold ml-2",children:[r.progress,"%"]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[r.category," | ",r.deadline]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>$(r.id),className:"bg-red-600 text-white rounded px-3 py-1 font-medium",children:"Remover"}),e.jsx("button",{onClick:()=>q(r),className:"bg-primary-light dark:bg-primary-dark text-white rounded px-3 py-1 font-medium",children:"Editar"})]})]},r.id))})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-primary-light dark:text-primary-dark font-semibold text-xl mb-3",children:"Certificados"}),e.jsxs("form",{className:"flex flex-wrap gap-3 mb-6",onSubmit:O,children:[e.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Título",value:i.title,onChange:r=>n({...i,title:r.target.value}),required:!0,"aria-label":"Título do Certificado"}),e.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Data",value:i.date,onChange:r=>n({...i,date:r.target.value}),required:!0,"aria-label":"Data do Certificado"}),e.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Emissor",value:i.issuer,onChange:r=>n({...i,issuer:r.target.value}),required:!0,"aria-label":"Emissor do Certificado"}),e.jsx("input",{type:"number",className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Progresso",value:i.progress,onChange:r=>n({...i,progress:Number(r.target.value)}),min:0,max:100,required:!0,"aria-label":"Progresso do Certificado"}),e.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"URL externa",value:i.externalUrl,onChange:r=>n({...i,externalUrl:r.target.value}),"aria-label":"URL externa do Certificado"}),e.jsx("button",{type:"submit",className:"bg-primary-light dark:bg-primary-dark text-white rounded-lg px-4 py-2 font-semibold transition hover:bg-primary-dark dark:hover:bg-primary-light",children:m?"Salvar Alteração":"Adicionar Certificado"}),m&&e.jsx("button",{type:"button",className:"bg-gray-200 dark:bg-gray-700 text-primary-light dark:text-primary-dark rounded-lg px-4 py-2 font-semibold",onClick:()=>{N(null),n({id:"",title:"",date:"",issuer:"",progress:0,externalUrl:""})},children:"Cancelar"})]}),E&&e.jsx("div",{className:"text-red-600 mb-4",role:"alert",children:E}),e.jsx("ul",{className:"space-y-2",children:h.map(r=>e.jsxs("li",{className:"bg-background-light dark:bg-gray-800 rounded-lg p-4 flex items-center justify-between gap-2 flex-wrap border border-border-light dark:border-border-dark",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-text-light dark:text-text-dark",children:r.title}),e.jsx("span",{className:"text-primary-light dark:text-primary-dark font-semibold ml-2",children:r.issuer}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[r.date," | ",r.progress,"% ",r.externalUrl&&e.jsx("a",{href:r.externalUrl,target:"_blank",rel:"noopener noreferrer",className:"text-primary-light dark:text-primary-dark underline ml-2",children:"Ver"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>z(r.id),className:"bg-red-600 text-white rounded px-3 py-1 font-medium",children:"Remover"}),e.jsx("button",{onClick:()=>_(r),className:"bg-primary-light dark:bg-primary-dark text-white rounded px-3 py-1 font-medium",children:"Editar"})]})]},r.id))})]})]})}):e.jsx(J,{onLogin:()=>y(!0)})}export{F as default};
