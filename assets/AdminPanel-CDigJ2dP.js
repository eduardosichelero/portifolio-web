import{r as o,j as r,G as T}from"./index-C3hPd_4k.js";const D="https://portifolio-api-mu.vercel.app/api";function L({onLogin:b}){const[g,h]=o.useState(""),[x,f]=o.useState(""),[p,k]=o.useState(""),j=async t=>{t.preventDefault(),k("");const s=await fetch(`${D}/auth`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({usuario:g,senha:x})});if(s.ok){const{token:d}=await s.json();sessionStorage.setItem("admin_token",d),b()}else k("Usuário ou senha inválidos")};return r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background-light dark:bg-background-dark",children:r.jsxs("form",{onSubmit:j,className:"bg-white dark:bg-gray-900 rounded-2xl shadow-lg p-8 min-w-[320px] flex flex-col gap-5",children:[r.jsx("h2",{className:"text-center text-primary-light dark:text-primary-dark font-bold text-2xl mb-2",children:"Painel Admin"}),r.jsx("label",{className:"font-medium text-gray-600 dark:text-gray-300",children:"Usuário"}),r.jsx("input",{placeholder:"Digite seu usuário",value:g,onChange:t=>h(t.target.value),required:!0,className:"p-2 rounded-lg border border-border-light dark:border-border-dark text-base bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark"}),r.jsx("label",{className:"font-medium text-gray-600 dark:text-gray-300",children:"Senha"}),r.jsx("input",{type:"password",placeholder:"Digite sua senha",value:x,onChange:t=>f(t.target.value),required:!0,className:"p-2 rounded-lg border border-border-light dark:border-border-dark text-base bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark"}),r.jsx("button",{type:"submit",className:"mt-2 bg-primary-light dark:bg-primary-dark text-white rounded-lg py-3 font-semibold text-lg cursor-pointer shadow transition hover:bg-primary-dark dark:hover:bg-primary-light",children:"Entrar"}),p&&r.jsx("div",{className:"text-red-600 text-center mt-2",children:p})]})})}const n="https://portifolio-api-mu.vercel.app/api";function _(){const[b,g]=o.useState([]),[h,x]=o.useState([]),[f,p]=o.useState(!0),[k,j]=o.useState(()=>!!sessionStorage.getItem("admin_token")),[t,s]=o.useState({id:"",title:"",deadline:"",progress:0,category:""}),[d,c]=o.useState({id:"",title:"",date:"",issuer:"",progress:0,externalUrl:""}),[m,N]=o.useState(null),[u,v]=o.useState(null),[S,y]=o.useState("");o.useEffect(()=>{Promise.all([fetch(`${n}/goals`).then(e=>e.json()),fetch(`${n}/certificates`).then(e=>e.json())]).then(([e,a])=>{g(Array.isArray(e)?e:e.goals||[]),x(Array.isArray(a)?a:a.certificates||[]),p(!1)})},[]);const A=async e=>{e.preventDefault();const a=sessionStorage.getItem("admin_token");if(m){const i={...t,id:m};(await fetch(`${n}/goals/${m}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify(i)})).ok&&(g(b.map(l=>l.id===m?i:l)),s({id:"",title:"",deadline:"",progress:0,category:""}),N(null))}else{const i={...t,id:crypto.randomUUID()};(await fetch(`${n}/goals`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify(i)})).ok&&(g([...b,i]),s({id:"",title:"",deadline:"",progress:0,category:""}))}},E=e=>{s(e),N(e.id)},$=async e=>{const a=sessionStorage.getItem("admin_token");await fetch(`${n}/goals/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}}),g(b.filter(i=>i.id!==e))},U=async e=>{e.preventDefault(),y("");const a=sessionStorage.getItem("admin_token");try{if(u){const i={...d,id:u};if((await fetch(`${n}/certificates/${u}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify(i)})).ok){const l=await fetch(`${n}/certificates`).then(C=>C.json());x(Array.isArray(l)?l:l.certificates||[]),c({id:"",title:"",date:"",issuer:"",progress:0,externalUrl:""}),v(null)}else y("Erro ao editar certificado.")}else{const i={...d,id:crypto.randomUUID()};if((await fetch(`${n}/certificates`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify(i)})).ok){const l=await fetch(`${n}/certificates`).then(C=>C.json());x(Array.isArray(l)?l:l.certificates||[]),c({id:"",title:"",date:"",issuer:"",progress:0,externalUrl:""})}else y("Erro ao adicionar certificado.")}}catch{y("Erro de conexão com o servidor.")}},G=e=>{c(e),v(e.id)},I=async e=>{const a=sessionStorage.getItem("admin_token");await fetch(`${n}/certificates/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}}),x(h.filter(i=>i.id!==e))},P=()=>{sessionStorage.removeItem("admin_token"),window.location.reload()};return k?f?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background-light dark:bg-background-dark",children:r.jsx("div",{className:"text-primary-light dark:text-primary-dark text-2xl font-semibold",children:"Carregando..."})}):r.jsx("div",{className:"min-h-screen font-sans",children:r.jsxs("div",{className:"max-w-3xl mx-auto my-16 bg-transparent rounded-2xl shadow-lg p-8 flex flex-col gap-12",children:[r.jsxs("header",{className:"flex justify-between items-center mb-12",children:[r.jsx("h2",{className:"text-primary-light dark:text-primary-dark font-bold text-3xl m-0",children:"Painel Admin"}),r.jsx("button",{className:"bg-primary-light dark:bg-primary-dark text-white rounded-lg px-4 py-2 font-semibold shadow transition hover:bg-primary-dark dark:hover:bg-primary-light",onClick:P,children:"Sair"})]}),r.jsxs("section",{children:[r.jsx("h3",{className:"text-primary-light dark:text-primary-dark font-semibold text-xl mb-3",children:"Goals"}),r.jsxs("form",{className:"flex flex-wrap gap-6 mb-10",onSubmit:A,children:[r.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Título",value:t.title,onChange:e=>s({...t,title:e.target.value}),required:!0,"aria-label":"Título do Goal"}),r.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Deadline",value:t.deadline,onChange:e=>s({...t,deadline:e.target.value}),required:!0,"aria-label":"Deadline do Goal"}),r.jsxs("select",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",value:t.category,onChange:e=>s({...t,category:e.target.value}),required:!0,"aria-label":"Categoria do Goal",children:[r.jsx("option",{value:"",disabled:!0,children:"Selecione a categoria"}),Object.entries(T).map(([e,a])=>r.jsx("option",{value:a,children:a},e))]}),r.jsx("input",{type:"number",className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Progresso",value:t.progress,onChange:e=>s({...t,progress:Number(e.target.value)}),min:0,max:100,required:!0,"aria-label":"Progresso do Goal"}),r.jsx("button",{type:"submit",className:"bg-primary-light dark:bg-primary-dark text-white rounded-lg px-4 py-2 font-semibold transition hover:bg-primary-dark dark:hover:bg-primary-light",children:m?"Salvar Alteração":"Adicionar Goal"}),m&&r.jsx("button",{type:"button",className:"bg-gray-200 dark:bg-gray-700 text-primary-light dark:text-primary-dark rounded-lg px-4 py-2 font-semibold",onClick:()=>{N(null),s({id:"",title:"",deadline:"",progress:0,category:""})},children:"Cancelar"})]}),r.jsx("ul",{className:"space-y-2",children:b.map(e=>r.jsxs("li",{className:"bg-background-light dark:bg-gray-800 rounded-lg p-4 flex items-center justify-between gap-2 flex-wrap border border-border-light dark:border-border-dark",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-text-light dark:text-text-dark",children:e.title}),r.jsxs("span",{className:"text-primary-light dark:text-primary-dark font-semibold ml-2",children:[e.progress,"%"]}),r.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[e.category," | ",e.deadline]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>$(e.id),className:"bg-red-600 text-white rounded px-3 py-1 font-medium",children:"Remover"}),r.jsx("button",{onClick:()=>E(e),className:"bg-primary-light dark:bg-primary-dark text-white rounded px-3 py-1 font-medium",children:"Editar"})]})]},e.id))})]}),r.jsxs("section",{children:[r.jsx("h3",{className:"text-primary-light dark:text-primary-dark font-semibold text-xl mb-3",children:"Certificados"}),r.jsxs("form",{className:"flex flex-wrap gap-6 mb-10",onSubmit:U,children:[r.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Título",value:d.title,onChange:e=>c({...d,title:e.target.value}),required:!0,"aria-label":"Título do Certificado"}),r.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Data",value:d.date,onChange:e=>c({...d,date:e.target.value}),required:!0,"aria-label":"Data do Certificado"}),r.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Emissor",value:d.issuer,onChange:e=>c({...d,issuer:e.target.value}),required:!0,"aria-label":"Emissor do Certificado"}),r.jsx("input",{type:"number",className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Progresso",value:d.progress,onChange:e=>c({...d,progress:Number(e.target.value)}),min:0,max:100,required:!0,"aria-label":"Progresso do Certificado"}),r.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"URL externa",value:d.externalUrl,onChange:e=>c({...d,externalUrl:e.target.value}),"aria-label":"URL externa do Certificado"}),r.jsx("button",{type:"submit",className:"bg-primary-light dark:bg-primary-dark text-white rounded-lg px-4 py-2 font-semibold transition hover:bg-primary-dark dark:hover:bg-primary-light",children:u?"Salvar Alteração":"Adicionar Certificado"}),u&&r.jsx("button",{type:"button",className:"bg-gray-200 dark:bg-gray-700 text-primary-light dark:text-primary-dark rounded-lg px-4 py-2 font-semibold",onClick:()=>{v(null),c({id:"",title:"",date:"",issuer:"",progress:0,externalUrl:""})},children:"Cancelar"})]}),S&&r.jsx("div",{className:"text-red-600 mb-4",role:"alert",children:S}),r.jsx("ul",{className:"space-y-2",children:h.map(e=>r.jsxs("li",{className:"bg-background-light dark:bg-gray-800 rounded-lg p-4 flex items-center justify-between gap-2 flex-wrap border border-border-light dark:border-border-dark",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-text-light dark:text-text-dark",children:e.title}),r.jsx("span",{className:"text-primary-light dark:text-primary-dark font-semibold ml-2",children:e.issuer}),r.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[e.date," | ",e.progress,"% ",e.externalUrl&&r.jsx("a",{href:e.externalUrl,target:"_blank",rel:"noopener noreferrer",className:"text-primary-light dark:text-primary-dark underline ml-2",children:"Ver"})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>I(e.id),className:"bg-red-600 text-white rounded px-3 py-1 font-medium",children:"Remover"}),r.jsx("button",{onClick:()=>G(e),className:"bg-primary-light dark:bg-primary-dark text-white rounded px-3 py-1 font-medium",children:"Editar"})]})]},e.id))})]})]})}):r.jsx(L,{onLogin:()=>j(!0)})}export{_ as default};
