import{r as o,j as r}from"./index-BJ1cd8SF.js";function P({onLogin:p}){const[c,m]=o.useState(""),[g,f]=o.useState(""),[u,h]=o.useState(""),y=async t=>{t.preventDefault(),h("");const s=await fetch("https://portifolio-api-mu.vercel.app/api/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({usuario:c,senha:g})});if(s.ok){const{token:a}=await s.json();sessionStorage.setItem("admin_token",a),p()}else h("Usuário ou senha inválidos")};return r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background-light dark:bg-background-dark",children:r.jsxs("form",{onSubmit:y,className:"bg-white dark:bg-gray-900 rounded-2xl shadow-lg p-8 min-w-[320px] flex flex-col gap-5",children:[r.jsx("h2",{className:"text-center text-primary-light dark:text-primary-dark font-bold text-2xl mb-2",children:"Painel Admin"}),r.jsx("label",{className:"font-medium text-gray-600 dark:text-gray-300",children:"Usuário"}),r.jsx("input",{placeholder:"Digite seu usuário",value:c,onChange:t=>m(t.target.value),required:!0,className:"p-2 rounded-lg border border-border-light dark:border-border-dark text-base bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark"}),r.jsx("label",{className:"font-medium text-gray-600 dark:text-gray-300",children:"Senha"}),r.jsx("input",{type:"password",placeholder:"Digite sua senha",value:g,onChange:t=>f(t.target.value),required:!0,className:"p-2 rounded-lg border border-border-light dark:border-border-dark text-base bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark"}),r.jsx("button",{type:"submit",className:"mt-2 bg-primary-light dark:bg-primary-dark text-white rounded-lg py-3 font-semibold text-lg cursor-pointer shadow transition hover:bg-primary-dark dark:hover:bg-primary-light",children:"Entrar"}),u&&r.jsx("div",{className:"text-red-600 text-center mt-2",children:u})]})})}function q(){const[p,c]=o.useState([]),[m,g]=o.useState([]),[f,u]=o.useState(!0),[h,y]=o.useState(()=>!!sessionStorage.getItem("admin_token")),[t,s]=o.useState({id:"",title:"",deadline:"",progress:0,category:""}),[a,n]=o.useState({id:"",title:"",date:"",issuer:"",progress:0,externalUrl:""}),[x,j]=o.useState(null),[b,v]=o.useState(null),[C,k]=o.useState("");o.useEffect(()=>{Promise.all([fetch("https://portifolio-api-mu.vercel.app/api/goals").then(e=>e.json()),fetch("https://portifolio-api-mu.vercel.app/api/certificates").then(e=>e.json())]).then(([e,i])=>{c(Array.isArray(e)?e:e.goals||[]),g(Array.isArray(i)?i:i.certificates||[]),u(!1)})},[]);const S=async e=>{e.preventDefault();const i=sessionStorage.getItem("admin_token");if(x){const d={...t,id:x};(await fetch(`https://portifolio-api-mu.vercel.app/api/goals/${x}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify(d)})).ok&&(c(p.map(l=>l.id===x?d:l)),s({id:"",title:"",deadline:"",progress:0,category:""}),j(null))}else{const d={...t,id:crypto.randomUUID()};(await fetch("https://portifolio-api-mu.vercel.app/api/goals",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify(d)})).ok&&(c([...p,d]),s({id:"",title:"",deadline:"",progress:0,category:""}))}},A=e=>{s(e),j(e.id)},E=async e=>{const i=sessionStorage.getItem("admin_token");await fetch(`https://portifolio-api-mu.vercel.app/api/goals/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${i}`}}),c(p.filter(d=>d.id!==e))},U=async e=>{e.preventDefault(),k("");const i=sessionStorage.getItem("admin_token");try{if(b){const d={...a,id:b};if((await fetch(`https://portifolio-api-mu.vercel.app/api/certificates/${b}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify(d)})).ok){const l=await fetch("https://portifolio-api-mu.vercel.app/api/certificates").then(w=>w.json());g(Array.isArray(l)?l:l.certificates||[]),n({id:"",title:"",date:"",issuer:"",progress:0,externalUrl:""}),v(null)}else k("Erro ao editar certificado.")}else{const d={...a,id:crypto.randomUUID()};if((await fetch("https://portifolio-api-mu.vercel.app/api/certificates",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify(d)})).ok){const l=await fetch("https://portifolio-api-mu.vercel.app/api/certificates").then(w=>w.json());g(Array.isArray(l)?l:l.certificates||[]),n({id:"",title:"",date:"",issuer:"",progress:0,externalUrl:""})}else k("Erro ao adicionar certificado.")}}catch{k("Erro de conexão com o servidor.")}},T=e=>{n(e),v(e.id)},G=async e=>{const i=sessionStorage.getItem("admin_token");await fetch(`https://portifolio-api-mu.vercel.app/api/certificates/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${i}`}}),g(m.filter(d=>d.id!==e))},I=()=>{sessionStorage.removeItem("admin_token"),window.location.reload()};return h?f?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background-light dark:bg-background-dark",children:r.jsx("div",{className:"text-primary-light dark:text-primary-dark text-2xl font-semibold",children:"Carregando..."})}):r.jsx("div",{className:"min-h-screen bg-background-light dark:bg-background-dark font-sans",children:r.jsxs("div",{className:"max-w-3xl mx-auto my-10 bg-white dark:bg-gray-900 rounded-2xl shadow-lg p-8 flex flex-col gap-8",children:[r.jsxs("header",{className:"flex justify-between items-center mb-4",children:[r.jsx("h2",{className:"text-primary-light dark:text-primary-dark font-bold text-3xl m-0",children:"Painel Admin"}),r.jsx("button",{className:"bg-primary-light dark:bg-primary-dark text-white rounded-lg px-4 py-2 font-semibold shadow transition hover:bg-primary-dark dark:hover:bg-primary-light",onClick:I,children:"Sair"})]}),r.jsxs("section",{children:[r.jsx("h3",{className:"text-primary-light dark:text-primary-dark font-semibold text-xl mb-3",children:"Goals"}),r.jsxs("form",{className:"flex flex-wrap gap-3 mb-6",onSubmit:S,children:[r.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Título",value:t.title,onChange:e=>s({...t,title:e.target.value}),required:!0,"aria-label":"Título do Goal"}),r.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Deadline",value:t.deadline,onChange:e=>s({...t,deadline:e.target.value}),required:!0,"aria-label":"Deadline do Goal"}),r.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Categoria",value:t.category,onChange:e=>s({...t,category:e.target.value}),required:!0,"aria-label":"Categoria do Goal"}),r.jsx("input",{type:"number",className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Progresso",value:t.progress,onChange:e=>s({...t,progress:Number(e.target.value)}),min:0,max:100,required:!0,"aria-label":"Progresso do Goal"}),r.jsx("button",{type:"submit",className:"bg-primary-light dark:bg-primary-dark text-white rounded-lg px-4 py-2 font-semibold transition hover:bg-primary-dark dark:hover:bg-primary-light",children:x?"Salvar Alteração":"Adicionar Goal"}),x&&r.jsx("button",{type:"button",className:"bg-gray-200 dark:bg-gray-700 text-primary-light dark:text-primary-dark rounded-lg px-4 py-2 font-semibold",onClick:()=>{j(null),s({id:"",title:"",deadline:"",progress:0,category:""})},children:"Cancelar"})]}),r.jsx("ul",{className:"space-y-2",children:p.map(e=>r.jsxs("li",{className:"bg-background-light dark:bg-gray-800 rounded-lg p-4 flex items-center justify-between gap-2 flex-wrap border border-border-light dark:border-border-dark",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-text-light dark:text-text-dark",children:e.title}),r.jsxs("span",{className:"text-primary-light dark:text-primary-dark font-semibold ml-2",children:[e.progress,"%"]}),r.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[e.category," | ",e.deadline]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>E(e.id),className:"bg-red-600 text-white rounded px-3 py-1 font-medium",children:"Remover"}),r.jsx("button",{onClick:()=>A(e),className:"bg-primary-light dark:bg-primary-dark text-white rounded px-3 py-1 font-medium",children:"Editar"})]})]},e.id))})]}),r.jsxs("section",{children:[r.jsx("h3",{className:"text-primary-light dark:text-primary-dark font-semibold text-xl mb-3",children:"Certificados"}),r.jsxs("form",{className:"flex flex-wrap gap-3 mb-6",onSubmit:U,children:[r.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Título",value:a.title,onChange:e=>n({...a,title:e.target.value}),required:!0,"aria-label":"Título do Certificado"}),r.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Data",value:a.date,onChange:e=>n({...a,date:e.target.value}),required:!0,"aria-label":"Data do Certificado"}),r.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Emissor",value:a.issuer,onChange:e=>n({...a,issuer:e.target.value}),required:!0,"aria-label":"Emissor do Certificado"}),r.jsx("input",{type:"number",className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"Progresso",value:a.progress,onChange:e=>n({...a,progress:Number(e.target.value)}),min:0,max:100,required:!0,"aria-label":"Progresso do Certificado"}),r.jsx("input",{className:"flex-1 min-w-[120px] p-2 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark text-base",placeholder:"URL externa",value:a.externalUrl,onChange:e=>n({...a,externalUrl:e.target.value}),"aria-label":"URL externa do Certificado"}),r.jsx("button",{type:"submit",className:"bg-primary-light dark:bg-primary-dark text-white rounded-lg px-4 py-2 font-semibold transition hover:bg-primary-dark dark:hover:bg-primary-light",children:b?"Salvar Alteração":"Adicionar Certificado"}),b&&r.jsx("button",{type:"button",className:"bg-gray-200 dark:bg-gray-700 text-primary-light dark:text-primary-dark rounded-lg px-4 py-2 font-semibold",onClick:()=>{v(null),n({id:"",title:"",date:"",issuer:"",progress:0,externalUrl:""})},children:"Cancelar"})]}),C&&r.jsx("div",{className:"text-red-600 mb-4",role:"alert",children:C}),r.jsx("ul",{className:"space-y-2",children:m.map(e=>r.jsxs("li",{className:"bg-background-light dark:bg-gray-800 rounded-lg p-4 flex items-center justify-between gap-2 flex-wrap border border-border-light dark:border-border-dark",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-medium text-text-light dark:text-text-dark",children:e.title}),r.jsx("span",{className:"text-primary-light dark:text-primary-dark font-semibold ml-2",children:e.issuer}),r.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[e.date," | ",e.progress,"% ",e.externalUrl&&r.jsx("a",{href:e.externalUrl,target:"_blank",rel:"noopener noreferrer",className:"text-primary-light dark:text-primary-dark underline ml-2",children:"Ver"})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>G(e.id),className:"bg-red-600 text-white rounded px-3 py-1 font-medium",children:"Remover"}),r.jsx("button",{onClick:()=>T(e),className:"bg-primary-light dark:bg-primary-dark text-white rounded px-3 py-1 font-medium",children:"Editar"})]})]},e.id))})]})]})}):r.jsx(P,{onLogin:()=>y(!0)})}export{q as default};
